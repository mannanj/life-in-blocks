<!-- @TODO: Button to show dates on top of blocks or not. By default, none.
    Active block does have the selected style though. -->

<script type="module" src="../custom/summbit-discrete-slider.js"></script>
<div id="x-container" [ngClass]="{'enabled': !isLoading,'disabled': isLoading}">
    <div class="x-axis">
        <div class="line"></div>
        <div class="arrow">
            &#8250;      
        </div>
        <div class="label">Week</div>
    </div>
</div>
<div id="y-container" [ngClass]="{'enabled': !isLoading,'disabled': isLoading}">
    <div class="y-axis">
        <div class="line"></div>
        <div class="arrow">
            &#8250;      
        </div>
        <div class="label">Year</div>
    </div>
</div>
<div id="blocks" *ngIf="getObjectKeys(weeksByYear)" [ngClass]="{'enabled': !isLoading,'disabled': isLoading}">
    <!-- <app-year-row
        *ngFor="let year of years"
        [zoom]="zoom"
        [size]="size"
        [_year]="year"
        [thisYear]="thisYear"
    >
    </app-year-row> -->
    <div 
        *ngFor="let year of getObjectKeys(weeksByYear)"
        class="row">
        <span class="label" [ngClass]="{'gold-underlined' : thisYear && thisYear === strToNum(year)}">{{ year }}</span>
        <app-block
            *ngFor="let week of weeksByYear[strToNum(year)]"
            [size]="size"
            [zoom]="zoom"
            [year]="strToNum(year)"
            [week]="week"
            [isEditing]="isEditing">
        </app-block>
    </div>
</div>
<div id="loading" *ngIf="isLoading || !getObjectKeys(weeksByYear)">
    <div class="row">
        <div class='block b1'></div>
        <div class='block b2'></div>
    </div>
    <div class="row">
        <div class='block b3'></div>
        <div class='block b4'></div>
    </div>
</div>
<div id="chart-controls" [ngClass]="{'border-grayed': isLoading}">
    <div id="size-picker" *ngIf="zoom" [ngClass]="{'disabled': isLoading}">
        <div *ngIf="!isLoading" class="label-slider">{{ !!sizeHrTemp? sizeHrTemp : sizeHr }} </div>
        <div *ngIf="isLoading" class="label-slider">
            <div class="spin"></div>
        </div>
        <summbit-discrete-slider
            id="summbit-discrete-slider-7"
            class="slider"
            (change)="changeZoom($event)"
            (input)="setSizeText($event)"
            [value]="floorVal(zoom)"
            min="0"
            max="7"
            orientation="top-to-bottom">
        </summbit-discrete-slider>
    </div>
</div>
<div *ngIf="isEditing" id="chart-action-bar">
    <div class="control"
        (click)="cancelEdits()"
        [ngClass]="{'enabled': !(zoom <= 0.5 || isLoading), 'disabled': zoom <= 0.5 || isLoading}">
        <svg width="17" height="17" style="color: red;">
            <image attr.xlink:href="{{ 'assets/icons/close-o.svg' }}" width="17" height="17"/>
        </svg>
    </div>
</div>